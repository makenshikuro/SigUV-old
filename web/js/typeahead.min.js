function typeahead(){profesores=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("nombre"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:_serverDB+"/webresources/profesores"});var a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("nombre"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:_serverDB+"/webresources/asignaturas"}),e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("nombre"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:_serverDB+"/webresources/espacios"});$("#busqueda-tab-profesor .typeahead").typeahead({hint:!0,highlight:!0,minLength:1,classNames:{input:"Typeahead-input",hint:"Typeahead-hint",selectable:"Typeahead-selectable",menu:"Typeahead-menu",dataset:"Typeahead-dataset",suggestion:"Typeahead-suggestion",empty:"Typeahead-empty",open:"Typeahead-open",cursor:"Typeahead-cursor"}},{name:"profesores",displayKey:"nombre",source:profesores,templates:{suggestion:Handlebars.compile('<div class="typeahead-resultados-profesores">{{nombre}} &#45; <span class="label label-primary">Dept. {{{trimString departamento}}}</span></div>')}}),$("#busqueda-tab-asignatura .typeahead").typeahead({hint:!0,highlight:!0,minLength:1,classNames:{input:"Typeahead-input",hint:"Typeahead-hint",selectable:"Typeahead-selectable",menu:"Typeahead-menu",dataset:"Typeahead-dataset",suggestion:"Typeahead-suggestion",empty:"Typeahead-empty",open:"Typeahead-open",cursor:"Typeahead-cursor"}},{name:"asignaturas",displayKey:"nombre",source:a,templates:{suggestion:Handlebars.compile('<div class="typeahead-resultados-asignaturas">{{nombre}} </div>')}}),$("#busqueda-tab-espacio .typeahead").typeahead({hint:!0,highlight:!0,minLength:1,classNames:{input:"Typeahead-input",hint:"Typeahead-hint",selectable:"Typeahead-selectable",menu:"Typeahead-menu",dataset:"Typeahead-dataset",suggestion:"Typeahead-suggestion",empty:"Typeahead-empty",open:"Typeahead-open",cursor:"Typeahead-cursor"}},{name:"espacios",displayKey:"idespacio",source:e,templates:{suggestion:Handlebars.compile('<div class="typeahead-resultados-espacios">{{nombre}} &#45; <span class="label label-primary">{{idedificio.idedificio}}</span></div>')}}),$("#busqueda-tab-todo .typeahead").typeahead({highlight:!0,hint:!0,minLength:1,classNames:{input:"Typeahead-input",hint:"Typeahead-hint",selectable:"Typeahead-selectable",menu:"Typeahead-menu",dataset:"Typeahead-dataset",suggestion:"Typeahead-suggestion",empty:"Typeahead-empty",open:"Typeahead-open",cursor:"Typeahead-cursor"}},{name:"profesores",display:"nombre",source:profesores,templates:{header:'<div class="typeahead-header-resultados"><span class="fa fa-users"></span>Profesores</h3>',suggestion:Handlebars.compile('<div class="typeahead-resultados-profesores">{{nombre}} &#45; <span class="label label-primary">Dept. {{{trimString departamento}}}</span></div>')}},{name:"asignaturas",display:"nombre",source:a,templates:{header:'<div class="typeahead-header-resultados"><span class="fa fa-graduation-cap"></span>Asignaturas</h3>',suggestion:Handlebars.compile('<div class="typeahead-resultados-asignaturas">{{nombre}} </div>')}},{name:"espacios",display:"idespacio",source:e,templates:{header:'<div class="typeahead-header-resultados"><span class="fa fa-sitemap"></span>Espacios</h3>',suggestion:Handlebars.compile('<div class="typeahead-resultados-espacios">{{nombre}} &#45; <span class="label label-primary">{{idedificio.idedificio}}</span></div>')}}),$("#busqueda-tab-profesor .typeahead").on("typeahead:selected",function(a,e){$("#localizar-profesor").attr("onclick","").attr("onclick","LocalizarProfesor("+e.idprofesor+");")}),$("#busqueda-tab-asignatura .typeahead").on("typeahead:selected",function(a,e){$("#listaDocentes").empty();var s,t=ListarDocentesAsignatura(e.idasignatura),o='<div class="table-responsive">';for(o+='<table class="table table-hover">',o+="<thead><tr><th>Nombre</th><th>Facultad</th><th>Departamento</th></tr></thead>",o+="<tbody>",s=0;s<t.length;s++){o+="<tr ";var d=t[s].departamento.split(",");"0"===t[s].visibilidad&&(o+='class ="danger"'),o+='onclick="LocalizarProfesor('+t[s].idprofesor+');">',o+="<td>"+t[s].nombre+"</td>",o+="<td>Dept. "+d[0]+" , "+t[s].idespacio.idedificio.idedificio+"</td>",o+="<td>"+t[s].correo+"</td>",o+="</tr>"}o+="</tbody>",o+="</table>",o+="</div>",$("#listaDocentes").append(o)}),$("#busqueda-tab-espacio .typeahead").on("typeahead:selected",function(a,e){$("#localizar-espacio").attr("onclick","").attr("onclick",'LocalizarEspacio("'+e.idespacio+'");')}),$("#busqueda-tab-todo .typeahead").on("typeahead:selected.espacios",function(a,e){if(e.departamento&&($("#localizar-all").show(),$("#listaDocentes").empty(),$("#listaTodo").empty(),$("#localizar-all").attr("onclick","").attr("onclick","LocalizarProfesor("+e.idprofesor+");")),e.idasignatura){$("#localizar-all").hide(),$("#listaTodo").empty();var s,t=ListarDocentesAsignatura(e.idasignatura),o='<div class="table-responsive">';for(o+='<table class="table table-hover">',o+="<thead><tr><th>Nombre</th><th>Facultad</th><th>Departamento</th></tr></thead>",o+="<tbody>",s=0;s<t.length;s++){o+="<tr ";var d=t[s].departamento.split(",");"0"===t[s].visibilidad&&(o+='class ="danger"'),o+='onclick="LocalizarProfesor('+t[s].idprofesor+');">',o+="<td>"+t[s].nombre+"</td>",o+="<td>Dept. "+d[0]+" , "+t[s].idespacio.idedificio.idedificio+"</td>",o+="<td>"+t[s].correo+"</td>",o+="</tr>"}o+="</tbody>",o+="</table>",o+="</div>",$("#listaTodo").append(o)}e.bloque&&($("#localizar-all").show(),$("#listaDocentes").empty(),$("#listaTodo").empty(),$("#localizar-all").attr("onclick","").attr("onclick",'LocalizarEspacio("'+e.idespacio+'");'))}),Handlebars.registerHelper("trimString",function(a){var e;if(e=a+"","undefined"!==e){var s=e.split(",");e=new Handlebars.SafeString(s[0])}else e="";return e})}function Buscador(){var a='<div class="modal-header">';a+='   <h4 class="modal-title">Buscador</h4>',a+="            </div>",a+='           <div class="modal-body">',a+="              <p> Buscador que nos permite localizar cualquier estancia de la ETSE, desde el punto de vista de las personas, las estancias, las denominaciones de espacios, o las aulas .</p>",a+='              <ul class="nav nav-tabs">',a+='     <li class="active"><a data-toggle="tab" href="#busqueda-tab-todo"><span class="fa fa-search"></span><span class="modal-tab-text">Todo</span></a></li>',a+='     <li><a data-toggle="tab" href="#busqueda-tab-profesor"><span class="fa fa-users"></span><span class="modal-tab-text">Profesor</span></a></li>',a+='     <li><a data-toggle="tab" href="#busqueda-tab-asignatura"><span class="fa fa-graduation-cap"></span><span class="modal-tab-text">Asignatura</span></a></li>',a+='     <li><a data-toggle="tab" href="#busqueda-tab-espacio"><span class="fa fa-sitemap"></span><span class="modal-tab-text">Espacio</span></a></li>',a+=" </ul>",a+=' <div class="tab-content">',a+='     <div id="busqueda-tab-todo" class="tab-pane fade in active">',a+='         <div class="clearM1"></div>',a+='         <p><input type="text" class="typeahead" placeholder="Campo de texto"></p>',a+='         <div id="listaTodo">',a+="         </div>",a+='         <button id="localizar-all" type="button" class="btn btn-default" >Localizar</button>',a+="     </div>",a+='     <div id="busqueda-tab-profesor" class="tab-pane fade">',a+='         <div class="clearM1"></div>',a+='         <p><input type="text" class="typeahead" placeholder="Campo de texto"></p>',a+='         <input type="hidden" id="todo">',a+='         <div id = "resultados-profesor"></div>',a+='         <button id="localizar-profesor" type="button" class="btn btn-default"  >Localizar</button>',a+="     </div>",a+='     <div id="busqueda-tab-asignatura" class="tab-pane fade">',a+='         <div class="clearM1"></div>',a+='<p><input type="text" class="typeahead" placeholder="Campo de texto"></p>',a+='         <div id="listaDocentes">',a+="         </div>",a+="     </div>",a+='     <div id="busqueda-tab-espacio" class="tab-pane fade">',a+='         <div class="clearM1"></div>',a+='         <p><input type="text" class="typeahead" placeholder="Campo de texto"></p>',a+='         <button id="localizar-espacio" type="button" class="btn btn-default">Localizar</button>',a+="     </div>",a+="  </div>",a+="</div>",a+='<div class="modal-footer">',a+='      <button type="button" class="btn btn-default" onclick="ModalClose();">Close</button>',a+="     </div>",map.fire("modal",{content:a,MODAL_CONTENT_CLS:"modal-content search"}),typeahead(),$(".search").css("margin-top",100)}