function initPanorama(a){var b,c;b=document.getElementById("visor-panorama"),camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1100),camera.target=new THREE.Vector3(0,0,0),scene=new THREE.Scene;var d=new THREE.TextureLoader;d.crossOrigin=!0,d.load("http://147.156.82.219/recursos/panoramicas/"+a+".JPG",function(a){var b=new THREE.SphereGeometry(500,60,40);b.scale(-1,1,1);var d=new THREE.MeshBasicMaterial({map:a});c=new THREE.Mesh(b,d),object=c,scene.add(c)}),renderer=new THREE.WebGLRenderer,renderer.setPixelRatio(window.devicePixelRatio),$(".pano").css("max-width",window.innerWidth/2+30),$(".pano").css("margin-top",100),renderer.setSize(window.innerWidth/2,window.innerHeight/2),b.appendChild(renderer.domElement),document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mouseup",onDocumentMouseUp,!1),document.addEventListener("mousewheel",onDocumentMouseWheel,!1),document.addEventListener("MozMousePixelScroll",onDocumentMouseWheel,!1),document.addEventListener("dragover",function(a){a.preventDefault(),a.dataTransfer.dropEffect="copy"},!1),document.addEventListener("dragenter",function(a){document.body.style.opacity=.5},!1),document.addEventListener("dragleave",function(a){document.body.style.opacity=1},!1),document.addEventListener("drop",function(a){a.preventDefault();var b=new FileReader;b.addEventListener("load",function(a){material.map.image.src=a.target.result,material.map.needsUpdate=!0},!1),b.readAsDataURL(a.dataTransfer.files[0]),document.body.style.opacity=1},!1),WindowResize();var e='<div class="panorama-control">';e+='<div id="iniR" title="Iniciar Rotaci&oacute;n" onclick="iniciaRotacion();" class="control-pano button"><i class="material-icons md-36">play_arrow</i></div>',e+='<div id="stopR" title="Detener Rotaci&oacute;n" onclick="detenerRotacion();" class="control-pano button"><i class="material-icons md-36">stop</i></div>',e+='<div title="Activar Pantalla Completa" onclick="fullscreen();" class="control-pano button request"><i class="material-icons md-36">fullscreen</i></div>',e+='<div title="Desactivar Pantalla Completa" onclick="cancelFullScreen();" class="control-pano button cancel"><i class="material-icons md-36">fullscreen_exit</i></div>',e+="</div>",$("canvas").after(e),$("#stopR").hide(),isPlay=!1,THREEx.FullScreen.bindKey({dblclick:!0}),document.querySelector(".button.request").addEventListener("click",function(){THREEx.FullScreen.request()},!1),document.querySelector(".button.cancel").addEventListener("click",function(){THREEx.FullScreen.cancel()},!1),$("canvas").mousedown(function(a){onDocumentMouseDown(a)})}function Change(a,b){var c=new THREE.TextureLoader;c.crossOrigin=!0;var d=c.load(_serverPano+a+".jpg");object.material.map=d,object.material.needsUpdate=!0;var e=$("ul.pagination.panorama li").length;for(indice=0;indice<e;indice++)indice===b?$("#panoTab"+indice).addClass("active"):$("#panoTab"+indice).removeClass("active")}function cancelFullScreen(){WindowResize()}function WindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),$(".pano").css("max-width",window.innerWidth/2+30),$("panorama-control").css("width",window.innerWidth/2),renderer.setSize(window.innerWidth/2,window.innerHeight/2)}function fullscreen(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),$(".pano").css("max-width",window.innerWidth),$(".pano").css({width:"100%",height:"auto"}),renderer.setSize(window.innerWidth,window.innerHeight),THREEx.FullScreen.request()}function iniciaRotacion(){$("#iniR").hide(),$("#stopR").show(),isPlay=!0}function detenerRotacion(){$("#stopR").hide(),$("#iniR").show(),isPlay=!1}function onDocumentMouseDown(a){a.preventDefault(),isUserInteracting=!0,onPointerDownPointerX=a.clientX,onPointerDownPointerY=a.clientY,onPointerDownLon=lon,onPointerDownLat=lat}function onDocumentMouseMove(a){isUserInteracting===!0&&(lon=.1*(onPointerDownPointerX-a.clientX)+onPointerDownLon,lat=.1*(a.clientY-onPointerDownPointerY)+onPointerDownLat)}function onDocumentMouseUp(a){isUserInteracting=!1}function onDocumentMouseWheel(a){a.wheelDeltaY?camera.fov-=.05*a.wheelDeltaY:a.wheelDelta?camera.fov-=.05*a.wheelDelta:a.detail&&(camera.fov+=1*a.detail),camera.updateProjectionMatrix()}function animate(){requestAnimationFrame(animate),update()}function update(){isPlay===!0&&isUserInteracting===!1&&(lon+=.1),lat=Math.max(-85,Math.min(85,lat)),phi=THREE.Math.degToRad(90-lat),theta=THREE.Math.degToRad(lon),camera.target.x=500*Math.sin(phi)*Math.cos(theta),camera.target.y=500*Math.cos(phi),camera.target.z=500*Math.sin(phi)*Math.sin(theta),camera.lookAt(camera.target),renderer.render(scene,camera)}var object,isPlay=!1;