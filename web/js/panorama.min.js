function initPanorama(e){var n,t;n=document.getElementById("visor-panorama"),camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1100),camera.target=new THREE.Vector3(0,0,0),scene=new THREE.Scene;var a=new THREE.TextureLoader;a.crossOrigin=!0,a.load("http://147.156.82.219/recursos/panoramicas/"+e+".JPG",function(e){var n=new THREE.SphereGeometry(500,60,40);n.scale(-1,1,1);var a=new THREE.MeshBasicMaterial({map:e});t=new THREE.Mesh(n,a),object=t,scene.add(t)}),renderer=new THREE.WebGLRenderer,renderer.setPixelRatio(window.devicePixelRatio),$(".pano").css("max-width",window.innerWidth/2+30),$(".pano").css("margin-top",100),renderer.setSize(window.innerWidth/2,window.innerHeight/2),n.appendChild(renderer.domElement),document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mouseup",onDocumentMouseUp,!1),document.addEventListener("mousewheel",onDocumentMouseWheel,!1),document.addEventListener("MozMousePixelScroll",onDocumentMouseWheel,!1),document.addEventListener("dragover",function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},!1),document.addEventListener("dragenter",function(e){document.body.style.opacity=.5},!1),document.addEventListener("dragleave",function(e){document.body.style.opacity=1},!1),document.addEventListener("drop",function(e){e.preventDefault();var n=new FileReader;n.addEventListener("load",function(e){material.map.image.src=e.target.result,material.map.needsUpdate=!0},!1),n.readAsDataURL(e.dataTransfer.files[0]),document.body.style.opacity=1},!1),WindowResize();var o='<div class="panorama-control">';o+='<div title="Activar Pantalla Completa" onclick="fullscreen();" class="control-pano button request"><i class="material-icons md-36">fullscreen</i></div>',o+='<div title="Desactivar Pantalla Completa" onclick="cancelFullScreen;" class="control-pano button cancel"><i class="material-icons md-36">fullscreen_exit</i></div>',o+="</div>",$("canvas").after(o),$("panorama-control").css("width",window.innerWidth/2),THREEx.FullScreen.bindKey({dblclick:!0}),document.querySelector(".button.request").addEventListener("click",function(){THREEx.FullScreen.request()},!1),document.querySelector(".button.cancel").addEventListener("click",function(){THREEx.FullScreen.cancel()},!1),$("canvas").mousedown(function(e){onDocumentMouseDown(e)})}function Change(e){var n=new THREE.TextureLoader;n.crossOrigin=!0;var t=n.load(_serverPano+e+".jpg");object.material.map=t,object.material.needsUpdate=!0}function cancelFullScreen(){WindowResize()}function WindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),$(".pano").css("max-width",window.innerWidth/2+30),$("panorama-control").css("width",window.innerWidth/2),renderer.setSize(window.innerWidth/2,window.innerHeight/2)}function fullscreen(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),$(".pano").css("max-width",window.innerWidth),renderer.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseDown(e){e.preventDefault(),isUserInteracting=!0,onPointerDownPointerX=e.clientX,onPointerDownPointerY=e.clientY,onPointerDownLon=lon,onPointerDownLat=lat}function onDocumentMouseMove(e){isUserInteracting===!0&&(lon=.1*(onPointerDownPointerX-e.clientX)+onPointerDownLon,lat=.1*(e.clientY-onPointerDownPointerY)+onPointerDownLat)}function onDocumentMouseUp(e){isUserInteracting=!1}function onDocumentMouseWheel(e){e.wheelDeltaY?camera.fov-=.05*e.wheelDeltaY:e.wheelDelta?camera.fov-=.05*e.wheelDelta:e.detail&&(camera.fov+=1*e.detail),camera.updateProjectionMatrix()}function animate(){requestAnimationFrame(animate),update()}function update(){isUserInteracting===!1&&(lon+=.1),lat=Math.max(-85,Math.min(85,lat)),phi=THREE.Math.degToRad(90-lat),theta=THREE.Math.degToRad(lon),camera.target.x=500*Math.sin(phi)*Math.cos(theta),camera.target.y=500*Math.cos(phi),camera.target.z=500*Math.sin(phi)*Math.sin(theta),camera.lookAt(camera.target),renderer.render(scene,camera)}var object;